# WhatsApp Desktop - 测试检查清单

使用此清单跟踪测试进度。在完成每个测试项后，将 `[ ]` 改为 `[x]`。

---

## 测试前准备

- [ ] 已安装 Node.js 18+
- [ ] 已运行 `npm install` 安装依赖
- [ ] 已阅读 TESTING_GUIDE.md
- [ ] 已运行 `node scripts/test-setup.js` 验证环境
- [ ] 准备好手机用于扫码

---

## 8.1 测试基本功能

### 启动应用并验证窗口显示

- [ ] 运行 `npm start` 成功启动应用
- [ ] Electron 窗口正常打开
- [ ] 窗口标题显示 "WhatsApp Desktop"
- [ ] 窗口大小为 1200x800 像素
- [ ] 控制台输出启动信息（版本号、Node.js 版本等）
- [ ] 控制台显示 "Electron 应用已就绪"
- [ ] 控制台显示 "创建 Electron 窗口..."
- [ ] 控制台显示 "初始化 WhatsApp 客户端..."
- [ ] 没有错误信息

**问题记录：**
```


```

### 验证 web.whatsapp.com 正确加载

- [ ] 窗口中加载 WhatsApp Web 页面
- [ ] 显示 WhatsApp 的 logo 和界面
- [ ] 页面加载完成（无持续加载动画）
- [ ] 控制台显示 "加载 WhatsApp Web..."
- [ ] 页面显示正常（无白屏或错误页面）
- [ ] 页面元素完整显示

**问题记录：**
```


```

### 扫描二维码并验证登录

- [ ] 窗口中显示二维码
- [ ] 控制台显示 "QR 码已生成，请使用手机扫描登录"
- [ ] 使用手机 WhatsApp 成功扫描二维码
- [ ] 扫描后，控制台显示 "认证成功"
- [ ] 控制台显示 "WhatsApp 客户端已就绪，可以正常使用"
- [ ] 窗口中显示完整的 WhatsApp 聊天界面
- [ ] 可以看到所有聊天记录
- [ ] 可以看到联系人列表

**问题记录：**
```


```

### 测试消息收发功能

- [ ] 在窗口中选择一个联系人
- [ ] 成功发送测试消息
- [ ] 发送的消息显示在聊天窗口中
- [ ] 消息显示已发送（单勾或双勾）
- [ ] 使用手机向该联系人发送消息
- [ ] 桌面应用收到手机发送的消息
- [ ] 控制台显示 "收到消息: [发送者] - [消息内容]"
- [ ] 消息实时同步
- [ ] 可以发送多条消息
- [ ] 消息顺序正确

**问题记录：**
```


```

**8.1 测试结果：** [ ] 通过  [ ] 失败

---

## 8.2 测试会话持久化

### 重启应用验证无需重新扫码

- [ ] 关闭应用（点击窗口关闭按钮）
- [ ] 等待 5 秒
- [ ] 重新运行 `npm start`
- [ ] 应用启动时不显示二维码
- [ ] 控制台显示 "认证成功"
- [ ] 控制台显示 "WhatsApp 客户端已就绪，可以正常使用"
- [ ] 窗口直接显示聊天界面（无需扫码）
- [ ] 所有聊天记录正常显示
- [ ] 可以正常收发消息

**问题记录：**
```


```

### 验证会话数据正确保存

- [ ] 检查 `session-data` 目录存在
- [ ] 目录中包含 `.wwebjs_auth` 子目录
- [ ] `.wwebjs_auth` 目录中包含会话文件
- [ ] 文件大小不为 0
- [ ] 文件权限正确

**检查命令：**
```bash
# Windows
dir session-data
dir session-data\.wwebjs_auth

# Linux/macOS
ls -la session-data
ls -la session-data/.wwebjs_auth
```

**问题记录：**
```


```

### 测试会话过期处理

- [ ] 在手机 WhatsApp 中打开 "设置" > "已连接的设备"
- [ ] 找到 "WhatsApp Desktop" 连接
- [ ] 点击 "退出登录"
- [ ] 桌面应用控制台显示 "客户端已断开连接"
- [ ] 窗口中重新显示二维码
- [ ] 控制台显示 "QR 码已生成，请使用手机扫描登录"
- [ ] 重新扫码可以成功登录

**问题记录：**
```


```

**8.2 测试结果：** [ ] 通过  [ ] 失败

---

## 8.3 测试错误场景

### 测试网络断开和重连

- [ ] 应用正常运行且已登录
- [ ] 断开网络连接（禁用网络适配器或断开 WiFi）
- [ ] 等待 10 秒
- [ ] 控制台显示 "客户端已断开连接"
- [ ] 控制台显示 "尝试重新连接 (1/5)..."
- [ ] 控制台显示 "开始重新连接..."
- [ ] 重新连接网络
- [ ] 应用自动重连成功
- [ ] 控制台显示 "认证成功"
- [ ] 控制台显示 "WhatsApp 客户端已就绪，可以正常使用"
- [ ] 聊天功能恢复正常

**问题记录：**
```


```

### 测试应用崩溃恢复

- [ ] 启动应用并登录
- [ ] 强制终止应用进程（任务管理器或 kill 命令）
- [ ] 重新启动应用
- [ ] 应用可以正常重启
- [ ] 会话数据未损坏
- [ ] 无需重新扫码（如果会话未过期）
- [ ] 应用恢复正常工作

**问题记录：**
```


```

### 验证错误日志输出

- [ ] 查看控制台输出
- [ ] 所有日志包含时间戳
- [ ] 日志包含级别标识（INFO、WARN、ERROR）
- [ ] 错误日志包含详细的错误信息
- [ ] 日志格式一致：`[时间戳] [级别] 消息内容`
- [ ] 日志易于阅读和理解

**示例日志格式验证：**
```
[2024-01-01T12:00:00.000Z] [INFO] Electron 应用已就绪
[2024-01-01T12:00:01.000Z] [INFO] 创建 Electron 窗口...
[2024-01-01T12:00:02.000Z] [WARN] 客户端已断开连接: NAVIGATION
[2024-01-01T12:00:03.000Z] [ERROR] 认证失败: Session expired
```

**问题记录：**
```


```

### 测试多次重连失败（可选）

**注意：** 此测试需要修改配置文件

- [ ] 修改 `src/config.js` 中的 `reconnect.maxAttempts` 为 2
- [ ] 启动应用并登录
- [ ] 断开网络
- [ ] 保持网络断开状态
- [ ] 控制台显示 "尝试重新连接 (1/2)..."
- [ ] 控制台显示 "尝试重新连接 (2/2)..."
- [ ] 控制台显示 "已达到最大重连次数，请手动重启应用"
- [ ] 应用停止尝试重连
- [ ] 恢复配置文件到原始状态

**问题记录：**
```


```

**8.3 测试结果：** [ ] 通过  [ ] 失败

---

## 测试总结

### 整体测试结果

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 8.1 测试基本功能 | [ ] 通过 [ ] 失败 | |
| 8.2 测试会话持久化 | [ ] 通过 [ ] 失败 | |
| 8.3 测试错误场景 | [ ] 通过 [ ] 失败 | |

### 发现的问题

1. 
2. 
3. 

### 改进建议

1. 
2. 
3. 

### 测试环境信息

- **测试日期：** _______________
- **测试人员：** _______________
- **操作系统：** _______________
- **Node.js 版本：** _______________
- **Electron 版本：** _______________
- **网络环境：** _______________

### 测试结论

[ ] 所有测试通过，应用可以正常使用
[ ] 部分测试失败，需要修复问题
[ ] 测试未完成

**签名：** _______________

**日期：** _______________
