<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WhatsApp Desktop - æ¬¢è¿</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #333;
      overflow: hidden;
    }

    .wizard-container {
      display: flex;
      flex-direction: column;
      height: 100vh;
      background: white;
    }

    .wizard-header {
      padding: 40px;
      text-align: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .wizard-header h1 {
      font-size: 32px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .wizard-header p {
      font-size: 16px;
      opacity: 0.9;
    }

    .wizard-content {
      flex: 1;
      padding: 40px;
      overflow-y: auto;
    }

    .wizard-step {
      display: none;
    }

    .wizard-step.active {
      display: block;
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .welcome-content {
      max-width: 600px;
      margin: 0 auto;
    }

    .welcome-content h2 {
      font-size: 24px;
      margin-bottom: 20px;
      color: #333;
    }

    .welcome-content p {
      font-size: 16px;
      line-height: 1.6;
      margin-bottom: 15px;
      color: #666;
    }

    .feature-list {
      list-style: none;
      margin: 30px 0;
    }

    .feature-list li {
      padding: 15px;
      margin-bottom: 10px;
      background: #f8f9fa;
      border-radius: 8px;
      display: flex;
      align-items: center;
    }

    .feature-list li::before {
      content: 'âœ“';
      display: inline-block;
      width: 24px;
      height: 24px;
      background: #667eea;
      color: white;
      border-radius: 50%;
      text-align: center;
      line-height: 24px;
      margin-right: 15px;
      flex-shrink: 0;
    }

    .migration-content {
      max-width: 600px;
      margin: 0 auto;
    }

    .migration-status {
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      margin: 20px 0;
    }

    .migration-status h3 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #333;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e9ecef;
      border-radius: 4px;
      overflow: hidden;
      margin: 15px 0;
    }

    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      transition: width 0.3s ease;
      width: 0%;
    }

    .migration-steps {
      list-style: none;
      margin-top: 20px;
    }

    .migration-steps li {
      padding: 10px 0;
      color: #666;
      display: flex;
      align-items: center;
    }

    .migration-steps li.completed {
      color: #28a745;
    }

    .migration-steps li.active {
      color: #667eea;
      font-weight: 500;
    }

    .migration-steps li::before {
      content: 'â—‹';
      margin-right: 10px;
      font-size: 20px;
    }

    .migration-steps li.completed::before {
      content: 'âœ“';
      color: #28a745;
    }

    .migration-steps li.active::before {
      content: 'â—‰';
      color: #667eea;
    }

    .alert {
      padding: 15px 20px;
      border-radius: 8px;
      margin: 20px 0;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .alert-info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    .wizard-footer {
      padding: 20px 40px;
      background: #f8f9fa;
      border-top: 1px solid #dee2e6;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 500;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-success {
      background: #28a745;
      color: white;
    }

    .doc-links {
      margin-top: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
    }

    .doc-links h3 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #333;
    }

    .doc-links a {
      display: block;
      padding: 10px 15px;
      margin: 5px 0;
      color: #667eea;
      text-decoration: none;
      background: white;
      border-radius: 6px;
      transition: all 0.2s ease;
    }

    .doc-links a:hover {
      background: #667eea;
      color: white;
      transform: translateX(5px);
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
      margin-right: 10px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="wizard-container">
    <div class="wizard-header">
      <h1>ğŸ‰ æ¬¢è¿ä½¿ç”¨ WhatsApp Desktop</h1>
      <p>å¤šè´¦å·ç®¡ç†ï¼Œè®©æ²Ÿé€šæ›´é«˜æ•ˆ</p>
    </div>

    <div class="wizard-content">
      <!-- Step 1: Welcome -->
      <div id="step-welcome" class="wizard-step active">
        <div class="welcome-content">
          <h2>æ¬¢è¿å‡çº§åˆ°å¤šè´¦å·ç‰ˆæœ¬ï¼</h2>
          <p>æˆ‘ä»¬æ£€æµ‹åˆ°æ‚¨ä¹‹å‰ä½¿ç”¨çš„æ˜¯å•è´¦å·ç‰ˆæœ¬ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥åŒæ—¶ç®¡ç†å¤šä¸ª WhatsApp è´¦å·äº†ï¼</p>
          
          <ul class="feature-list">
            <li>
              <div>
                <strong>å¤šè´¦å·æ”¯æŒ</strong><br>
                åŒæ—¶è¿è¡Œå¤šä¸ª WhatsApp è´¦å·ï¼Œæ¯ä¸ªè´¦å·ç‹¬ç«‹è¿è¡Œ
              </div>
            </li>
            <li>
              <div>
                <strong>å®Œå…¨éš”ç¦»</strong><br>
                æ¯ä¸ªè´¦å·æ‹¥æœ‰ç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´å’Œç½‘ç»œé…ç½®
              </div>
            </li>
            <li>
              <div>
                <strong>ä»£ç†æ”¯æŒ</strong><br>
                ä¸ºæ¯ä¸ªè´¦å·é…ç½®ç‹¬ç«‹çš„ä»£ç†ï¼Œå®ç° IP éš”ç¦»
              </div>
            </li>
            <li>
              <div>
                <strong>ç¿»è¯‘åŠŸèƒ½</strong><br>
                ä¿ç•™æ‰€æœ‰ç°æœ‰çš„ç¿»è¯‘åŠŸèƒ½ï¼Œæ”¯æŒæ¯ä¸ªè´¦å·ç‹¬ç«‹é…ç½®
              </div>
            </li>
          </ul>

          <div class="alert alert-info">
            <strong>æ•°æ®è¿ç§»è¯´æ˜ï¼š</strong><br>
            æˆ‘ä»¬å°†è‡ªåŠ¨è¿ç§»æ‚¨ç°æœ‰çš„ä¼šè¯æ•°æ®å’Œç¿»è¯‘é…ç½®ã€‚åŸå§‹æ•°æ®å°†è¢«ä¿ç•™ä½œä¸ºå¤‡ä»½ï¼Œæ•´ä¸ªè¿‡ç¨‹å®‰å…¨å¯é ã€‚
          </div>

          <div class="doc-links">
            <h3>ğŸ“š ç›¸å…³æ–‡æ¡£</h3>
            <a href="#" onclick="openExternal('docs/USER_GUIDE.md'); return false;">ç”¨æˆ·æŒ‡å—</a>
            <a href="#" onclick="openExternal('docs/MIGRATION_GUIDE.md'); return false;">è¿ç§»æŒ‡å—</a>
            <a href="#" onclick="openExternal('docs/FAQ.md'); return false;">å¸¸è§é—®é¢˜</a>
          </div>
        </div>
      </div>

      <!-- Step 2: Migration -->
      <div id="step-migration" class="wizard-step">
        <div class="migration-content">
          <h2>æ­£åœ¨è¿ç§»æ•°æ®...</h2>
          
          <div class="migration-status">
            <h3>è¿ç§»è¿›åº¦</h3>
            <div class="progress-bar">
              <div id="progress-bar-fill" class="progress-bar-fill"></div>
            </div>
            <ul id="migration-steps" class="migration-steps">
              <li id="step-1">åˆ›å»º profiles ç›®å½•</li>
              <li id="step-2">è¿ç§»ä¼šè¯æ•°æ®</li>
              <li id="step-3">åŠ è½½ç¿»è¯‘é…ç½®</li>
              <li id="step-4">åˆ›å»ºé»˜è®¤è´¦å·</li>
              <li id="step-5">å®Œæˆè¿ç§»</li>
            </ul>
          </div>

          <div id="migration-result" style="display: none;"></div>
        </div>
      </div>

      <!-- Step 3: Complete -->
      <div id="step-complete" class="wizard-step">
        <div class="welcome-content">
          <h2>ğŸŠ è¿ç§»å®Œæˆï¼</h2>
          
          <div class="alert alert-success">
            <strong>æ­å–œï¼</strong> æ‚¨çš„æ•°æ®å·²æˆåŠŸè¿ç§»åˆ°æ–°çš„å¤šè´¦å·æ¶æ„ã€‚
          </div>

          <p>æ‚¨ç°åœ¨å¯ä»¥ï¼š</p>
          <ul class="feature-list">
            <li>
              <div>
                åœ¨ä¸»ç•Œé¢æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰è´¦å·
              </div>
            </li>
            <li>
              <div>
                æ·»åŠ æ–°çš„ WhatsApp è´¦å·
              </div>
            </li>
            <li>
              <div>
                ä¸ºæ¯ä¸ªè´¦å·é…ç½®ç‹¬ç«‹çš„ä»£ç†å’Œç¿»è¯‘è®¾ç½®
              </div>
            </li>
            <li>
              <div>
                åŒæ—¶è¿è¡Œå¤šä¸ªè´¦å·ï¼Œæé«˜å·¥ä½œæ•ˆç‡
              </div>
            </li>
          </ul>

          <div class="alert alert-info">
            <strong>æç¤ºï¼š</strong> æ‚¨çš„åŸå§‹æ•°æ®å·²è¢«ä¿ç•™åœ¨ <code>session-data/</code> ç›®å½•ä¸­ä½œä¸ºå¤‡ä»½ã€‚
          </div>
        </div>
      </div>
    </div>

    <div class="wizard-footer">
      <button id="btn-back" class="btn btn-secondary" style="display: none;">è¿”å›</button>
      <div></div>
      <button id="btn-next" class="btn btn-primary">å¼€å§‹è¿ç§»</button>
    </div>
  </div>

  <script>
    let currentStep = 1;
    const totalSteps = 3;

    // æ­¥éª¤ç®¡ç†
    function showStep(step) {
      document.querySelectorAll('.wizard-step').forEach(el => {
        el.classList.remove('active');
      });
      
      if (step === 1) {
        document.getElementById('step-welcome').classList.add('active');
        document.getElementById('btn-next').textContent = 'å¼€å§‹è¿ç§»';
        document.getElementById('btn-next').disabled = false;
      } else if (step === 2) {
        document.getElementById('step-migration').classList.add('active');
        document.getElementById('btn-next').style.display = 'none';
      } else if (step === 3) {
        document.getElementById('step-complete').classList.add('active');
        document.getElementById('btn-next').textContent = 'å¼€å§‹ä½¿ç”¨';
        document.getElementById('btn-next').style.display = 'block';
        document.getElementById('btn-next').disabled = false;
        document.getElementById('btn-next').className = 'btn btn-success';
      }
      
      currentStep = step;
    }

    // æ›´æ–°è¿ç§»è¿›åº¦
    function updateMigrationProgress(stepIndex, status = 'active') {
      const steps = document.querySelectorAll('.migration-steps li');
      steps.forEach((step, index) => {
        step.classList.remove('active', 'completed');
        if (index < stepIndex) {
          step.classList.add('completed');
        } else if (index === stepIndex) {
          step.classList.add(status);
        }
      });

      const progress = ((stepIndex + 1) / steps.length) * 100;
      document.getElementById('progress-bar-fill').style.width = progress + '%';
    }

    // æ‰§è¡Œè¿ç§»
    async function executeMigration() {
      showStep(2);
      
      // ç›‘å¬è¿ç§»äº‹ä»¶
      window.wizardAPI.onMigrationStarted(() => {
        updateMigrationProgress(0);
      });

      window.wizardAPI.onMigrationCompleted((result) => {
        updateMigrationProgress(4, 'completed');
        setTimeout(() => {
          showStep(3);
        }, 1000);
      });

      window.wizardAPI.onMigrationFailed((result) => {
        const resultDiv = document.getElementById('migration-result');
        resultDiv.innerHTML = `
          <div class="alert alert-error">
            <strong>è¿ç§»å¤±è´¥ï¼š</strong><br>
            ${result.message || 'æœªçŸ¥é”™è¯¯'}
          </div>
        `;
        resultDiv.style.display = 'block';
        document.getElementById('btn-next').textContent = 'é‡è¯•';
        document.getElementById('btn-next').style.display = 'block';
        document.getElementById('btn-next').disabled = false;
      });

      // æ¨¡æ‹Ÿè¿ç§»æ­¥éª¤è¿›åº¦
      updateMigrationProgress(0);
      await new Promise(resolve => setTimeout(resolve, 500));
      
      updateMigrationProgress(1);
      await new Promise(resolve => setTimeout(resolve, 500));
      
      updateMigrationProgress(2);
      await new Promise(resolve => setTimeout(resolve, 500));
      
      updateMigrationProgress(3);
      
      // å¼€å§‹å®é™…è¿ç§»
      const result = await window.wizardAPI.startMigration();
      
      if (!result.success) {
        window.wizardAPI.onMigrationFailed(result);
      }
    }

    // æŒ‰é’®äº‹ä»¶
    document.getElementById('btn-next').addEventListener('click', async () => {
      if (currentStep === 1) {
        document.getElementById('btn-next').disabled = true;
        document.getElementById('btn-next').innerHTML = '<span class="spinner"></span>è¿ç§»ä¸­...';
        await executeMigration();
      } else if (currentStep === 3) {
        await window.wizardAPI.complete();
      }
    });

    // æ‰“å¼€å¤–éƒ¨é“¾æ¥ï¼ˆå ä½ç¬¦å‡½æ•°ï¼‰
    function openExternal(url) {
      console.log('Open external:', url);
      // åœ¨å®é™…å®ç°ä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨ Electron çš„ shell.openExternal
    }

    // åˆå§‹åŒ–
    showStep(1);
  </script>
</body>
</html>
