# WhatsApp 桌面客户端和后台管理系统需求文档

## 项目概述

基于 Electron 开发 WhatsApp 桌面客户端，支持 Windows、MacOS。应用直接加载官方 WhatsApp Web，并通过内容脚本注入提供实时翻译功能。

### 核心功能
- 多账号登录同时在线，一键切换账号
- 多账号环境完全隔离，防封号级别
- 根据文档的桌面客户端和后台管理功能进行开发

### 会话持久化
使用 RemoteAuth 或把 session 存入加密数据库，避免频繁扫码

---

# 一、桌面客户端完整功能清单

## 1. 多账号管理系统

### 需求描述
提供稳定可靠的多账号WhatsApp管理功能

### 用户场景
- 跨境电商商家需要同时管理多个WhatsApp账号
- 不同账号用于不同市场或客户群体
- 需要快速切换账号进行客户服务



## 2. 环境配置

### 2.1 代理设置

- **启用代理**（开关按钮）
  - 开启后才允许填写代理信息
- **选择代理**（下拉）
  - 手动选择已有的代理配置，支持刷新
- **协议**（下拉）
  - HTTP / HTTPS / SOCKS5
- **主机 / 端口**（输入框）
- **用户名 / 密码**（输入框，可隐藏显示）
- **检测代理服务**（按钮）
  - 验证代理配置是否可用
- **检测当前网络**（按钮）
  - 查看当前 IP 和网络状态
- **智能填写**（文本框，可粘贴 IP 信息自动识别）

---

### 2.2 指纹设置

#### 浏览器与系统

- **浏览器选择**（下拉）：Chrome 108、Edge、Firefox 等
- **操作系统**（单选）：Windows、MacOS
- **User Agent**（可手动修改 / 随机生成）

#### WebGL

- **WebGL 元数据**
  - 模式：真实 / 自定义
  - 厂商（如 Google Inc.）
  - 渲染器（如 Intel Iris Xe Graphics）
- **WebGL 图像**：随机 / 真实

#### WebRTC

- 模式：替换 / 真实 / 禁用

#### 其他环境属性

- **时区**：基于 IP / 真实 / 自定义
- **地理位置**：询问 / 禁止 / 基于 IP 生成
- **语言**：基于 IP / 自定义
- **分辨率**：真实 / 自定义
- **字体**：继承系统 / 自定义

#### Canvas & Audio

- **Canvas**：随机 / 真实
- **Audio**：随机 / 真实
- **ClientRects**：随机 / 真实

#### 设备信息

- **设备名称**：真实 / 自定义（如 LAPTOP-FZ3DGZ7）
- **MAC 地址**：真实 / 自定义
- **CPU 内核数**：真实 / 自定义（2/4/8/16 核）
- **内存大小**：真实 / 自定义（2G/4G/8G/16G）

#### 其他硬件

- **蓝牙**：启用 / 禁用
- **电池**：真实 / 隐私模式
- **端口扫描保护**：启用 / 关闭

#### Cookie

- 自定义 Cookie（JSON 格式：`[{"name":"xx","value":"yy","domain":"zz"}]`）

#### 全局按钮

- **一键生成指纹**
- **应用**（保存设置）

---

## 3. 翻译设置

### 3.1 消息翻译（聊天窗口接收的消息）

- **自动翻译开关**
- **翻译引擎选择**：谷歌翻译（免费）、GPT-4、Gemini、DeepSeek、自定义ai api翻译
  - 说明：聊天窗口翻译使用正常翻译，不应用风格参数，避免过多翻译成本
  - 建议：日常聊天可使用谷歌翻译节省成本，重要对话可切换到AI翻译
- **源语言**：自动检测
- **目标语言**：中文简体 / 英文 / 其他语言
- **群组翻译**：开关

### 3.2 输入框翻译（发送消息前的翻译）

- **是否开启**：开关
- **翻译引擎选择**：谷歌翻译（免费）、GPT-4、Gemini、DeepSeek、自定义ai api翻译
  - 说明：输入框翻译可独立选择引擎，与聊天窗口翻译引擎分离
- **翻译风格**（下拉）：通用、正式、口语化、亲切、幽默、礼貌、强硬、简洁、激励、中立、专业
  - 说明：翻译风格仅在输入框翻译时生效，使用AI翻译引擎时才有效
  - AI翻译会根据选择的风格调整提示词，输出符合风格的翻译内容

### 3.3 扩展功能

- **好友独立翻译**
- **禁发中文**（如果勾选，输入中文会被拦截）
- **实时翻译**
- **反向翻译**
- **语音翻译**
- **图片翻译**

---

## 4. 客户画像

### 4.1 客户信息

- **昵称备注**（文本框，100 字）
- **电话**（输入框）
- **地址**（输入框）
- **生日**（日期选择）
- **性别**：女 / 男 / 其他
- **备注**（200 字）
- **国家**（下拉选择）
- **客户标签**（多选，下拉）

### 4.2 销售信息

- **客户价值**：高价值 / 中等 / 低价值
- **销售阶段**：初步接触 / 跟进中 / 成交 / 复购
- **社媒来源**：WhatsApp / Facebook / Telegram / Twitter / TikTok 等

### 4.3 公司信息

- **公司名称 / 部门 / 职位**（可扩展字段）

### 4.4 备注录

- **输入框**：300 字
- **历史记录展示**：时间 + 内容

---

## 5. 快捷回复

### 5.1 平台支持

- WhatsApp / Telegram

### 5.2 内容管理

- **分组**：支持新建 / 编辑 / 删除
- **添加内容类型**：文本 / 图片 / 音频 / 视频 / 图文 / 名片
- **搜索快捷回复**（关键词）
- **导入 / 导出**（支持模板化）

### 5.3 回复方式

- **原文发送**
- **翻译后发送**
- **个人回复 / 公共回复**
- **关键词触发**

### 5.4 发送入口

- 快捷回复 → 一键发送
- 输入框快速插入

---

## 6. 联系人管理

- **搜索联系人**：手机号 / ID
- **选择标签**（下拉筛选）
- **会话类型**：全部 / 私聊 / 群聊
- **消息状态**：全部 / 未读 / 未回 / 已读未回
- **联系人信息展示**：头像、昵称、号码、最后消息时间
- **批量选择**：全选 / 反选
- **群发消息选择**：将勾选的联系人加入群发

---

## 7. 群发消息

### 7.1 创建群发

- **选择联系人**：选择多个联系人
- **设置内容**：文字 / 图片 / 语音 / 视频 / 文件 / 快捷回复模板

### 7.2 任务管理

- **任务信息**：ID、名称、平台、已发/总数、状态、开始/结束时间
- **任务状态**：等待中 / 进行中 / 已完成 / 已暂停 / 失败
- **任务操作**：查看详情 / 编辑 / 删除 / 重试

### 7.3 任务控制

- **批量删除**
- **一键清空**
- **一键停止**
- **顺序发送**：按任务创建时间依次发送
- **保持在线提醒**：否则任务失败

### 7.4 风控保护

- **提示语**："群发可能触发平台风控，请合理控制使用"
- **速率限制**（客户端可以配置）
- **随机间隔**
- **每日限额**
- **失败任务重试**



## 8. 客户重复提醒系统

### 需求描述
识别同一客户在不同账号中的存在，避免重复跟进

### 用户场景
- 同一客户通过不同账号联系
- 多个客服同时服务同一客户
- 需要统一客户信息和跟进记录

---

# 二、Web管理后台功能清单

## 1. RBAC权限系统

## 2. 激活码管理

### 激活码管理功能
- 添加、删除、管理激活码
- 激活码与客户端功能绑定，未激活无法使用客户端
- 激活码只做桌面客户端激活作用，激活码可以进行备注

### 管理功能
- **激活码管理**：
  - 添加、删除、管理激活码
  - 激活码与客户端功能绑定控制
  - 激活码备注信息管理
- **使用监控**：
  - 激活码使用状态实时监控
  - 激活码有效期管理
  - 使用统计和报表


## 3. 账号管理

### 账号列表
- 展示所有激活码下的已登录账号
- 账号信息：用户名/昵称、手机号、所属激活码、社交平台（WhatsApp/Telegram）、在线状态、登录IP代理、首次/最后活跃时间、备注
- 操作：移除账号、强制下线、日志记录


## 4. 敏感词监控

### 敏感词管理
- 新增敏感词（设置是否允许发送、是否启用监控、是否通知提醒、是否区分大小写）
- 编辑、删除敏感词
- 搜索与批量删除敏感词

### 触发记录
- 统计触发次数
- 记录触发的账号、消息、时间
- 是否允许发送的逻辑（禁止发送则拦截，允许发送则后台记录）

## 5. 敏感行为监控

### 行为类型分类
- 删除消息、编辑消息、删除会话、消息归档、发送消息等

### 行为记录
- 操作类型、激活码、应用（WhatsApp / Telegram）、发出账号、接收账号、消息内容、操作时间
- 异常行为的预警通知

### 行为设置
- 针对不同操作类型（删除消息、编辑消息、发送图片/视频/语音/附件等）配置：
  - 是否允许发送
  - 是否开启监控
  - 是否启用提醒
- 触发次数统计



## 6. 客户管理

### 客户列表
- 查询与筛选（平台、激活码、性别、国家、时间段等）
- 客户基本信息（昵称、手机号、标签、备注、所属社交账号）
- 操作：查看聊天记录、客户详情

### 标签管理与统计
- 标签添加、重置、批量设置
- 标签使用次数、覆盖人数统计

### 跟进记录
- 对客户的跟进日志，时间+跟进人+内容

## 7. 聊天记录

### 跨平台支持
- 支持 WhatsApp、Telegram

### 记录范围
- 保留最近一个月的聊天内容

### 功能
- 搜索（激活码/备注/昵称/平台）
- 查看对话列表及具体聊天内容
- 翻译设置（源语言、目标语言，支持入站和出站翻译）
- 导出聊天记录


## 8. 运营模块
- 代理 IP 管理：账号登录所使用的代理记录
- 日志记录：系统级操作日志，便于审计
- 运营管理：可扩展用于统计报表、活跃账号数、消息数等


## 9. 翻译API设置

- 翻译服务配置管理
- API密钥管理
- 服务提供商设置





## 10. 监听客户重复提醒系统

### 需求描述
基于WhatsApp手机号唯一性特征，识别同一客户在不同激活码账号中的存在，避免重复跟进，提升客户服务效率。

### 用户场景
- 同一客户通过不同WhatsApp账号联系不同客服
- 多个客服同时服务同一客户导致信息不同步
- 需要统一客户信息和跟进记录，提供一致的服务体验
- 避免重复营销和客户骚扰

### 核心功能模块

#### 10.1 手机号识别机制
- **WhatsApp号码标准化**：
  - 统一处理国际号码格式（+国家代码+号码）
  - 自动去除空格、括号、破折号等格式字符
  - 支持各国号码格式标准化

- **号码去重检测**：
  - 基于标准化后的手机号进行精确匹配
  - 建立全局手机号索引表
  - 实时维护手机号与激活码的映射关系

#### 10.2 重复检测策略
- **实时检测**：
  - 新客户添加时立即检查手机号是否已存在
  - 客户手机号变更时重新检测
  - 新消息到达时验证发送方手机号

- **批量检测**：
  - 定时任务：每日凌晨全量扫描所有客户手机号
  - 手动触发：管理员可主动发起重复检测
  - 数据导入时：批量导入客户时进行重复检查

#### 10.3 通知与提醒系统
- **客户端实时提醒**：
  - 弹窗通知：检测到重复手机号时立即提醒
  - 声音提醒：重要重复事件声音提示
  - 视觉标记：客户列表中高亮显示重复客户
  - 聊天界面：在重复客户的聊天窗口显示提醒标识

- **后台管理通知**：
  - 消息中心：统一的重复客户提醒列表
  - 邮件通知：重要重复事件发送邮件给管理员
  - 系统日志：记录所有重复检测事件

#### 10.4 重复客户信息展示
- **重复客户详情**：
  - 显示该手机号对应的所有激活码账号
  - 展示每个账号下的客户基本信息（昵称、标签、备注等）
  - 显示各账号的最后联系时间和沟通记录

- **跟进记录整合**：
  - 按时间线展示所有激活码账号的沟通历史
  - 标注每次沟通的服务人员和所属激活码
  - 高亮显示重要的客户节点（如成交、投诉等）

#### 10.5 查询与管理功能
- **重复客户查询**：
  - 按手机号精确查询重复情况
  - 按激活码查看该账号下的所有重复客户
  - 按时间段查询新增重复客户

- **统计分析**：
  - 重复客户数量统计（总计、按激活码分布）
  - 重复率计算（重复客户/总客户数）
  - 活跃重复客户统计（指定时间段内有互动的重复客户）

- **数据导出**：
  - 重复客户列表导出Excel
  - 包含手机号、激活码、客户基本信息等字段
  - 支持自定义查询条件导出

#### 10.6 处理与跟进机制
- **客户状态管理**：
  - 标记重复客户状态（待处理、已确认、已忽略）
  - 指定主要负责人（选择哪个激活码的客服主要负责）
  - 记录处理备注和决策原因

- **客服协作**：
  - 支持跨激活码客服之间的备注共享
  - 重要信息同步提醒
  - 客户转移功能（将客户从一个激活码转移到另一个）

#### 10.7 系统配置与权限
- **通知设置**：
  - 客户端提醒开关配置
  - 邮件通知接收人设置
  - 提醒频率控制（避免过度提醒）

- **权限控制**：
  - 普通客服：仅查看自己负责的重复客户
  - 主管：查看团队内所有重复客户
  - 管理员：全局重复客户管理和配置权限

#### 10.8 操作日志与审计
- **操作记录**：
  - 重复客户检测日志
  - 人工处理记录（确认、忽略、转移等）
  - 客户状态变更历史

- **审计功能**：
  - 操作人员和时间记录
  - 数据变更追踪
  - 异常操作告警

### 技术实现要点
- **数据结构**：建立手机号到激活码的反向索引表
- **性能优化**：使用哈希表实现O(1)时间复杂度的手机号查找
- **数据一致性**：确保各激活码客户数据与重复检测结果同步
- **隐私保护**：手机号敏感信息加密存储和传输

